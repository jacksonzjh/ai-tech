<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


code {
  font-family: Menlo, Monaco, Consolas, Courier New, monospace;
  word-break: break-word;
  border-radius: .125rem;
  overflow-x: auto;
  background-color: #fff5f5;
  color: #ff502c;
  font-size: 0.87em;
  padding: 0.065em 0.4em;
}

a {
  text-decoration: none;
  color: #0269c8;
  border-bottom: 1px solid #d1e9ff;
}

code::before {
  content: none;
}

code::after {
  content: none;
}

#write {
  font-size: 16px;
  line-height: 26px;
  max-width: 928px;
}

@media only screen and (min-width: 87.5rem) {
  #write {
    max-width: 1024px;
  }
}

@media only screen and (min-width: 112.5rem) {
  #write {
    max-width: 1200px;
  }
}
p {
  line-height: inherit;
    margin-top: 22px;
    margin-bottom: 22px;
}
h1 {
  font-size: 2.5rem;
  line-height: 2.75rem;
  margin-bottom: 1.5rem;
  letter-spacing: -0.0938rem;
}

h2 {
  font-size: 1.375rem;
  line-height: 2.125rem;
  padding-bottom: .75rem;
  border-bottom: .0625rem solid #ececec;
  font-weight: bold;
}

h3 {
  font-size: 1.25rem;
  line-height: 1.75rem;
  margin-top: 2.1875rem;
  margin-bottom: .625rem;
  padding-bottom: .3125rem;
}

h4 {
  font-size: 1.125rem;
  line-height: 1.625rem;
  margin-top: 2.1875rem;
  margin-bottom: .625rem;
  padding-bottom: .3125rem;
  font-weight: bold;
}

h5 {
  font-size: 15.52px;
  line-height: 20px;
  margin-bottom: 24px;
  font-weight: bold;
}

h6 {
  font-size: 14.88px;
  line-height: 16px;
  margin-bottom: 12px;
}

pre,
code,
kbd,
tt,
var {
  font-size: 0.875em;
}

blockquote {
  color: #666;
  padding: 10px 23px;
  margin: 22px 0;
  border-left: 4px solid #cbcbcb;
  background-color: #f8f8f8;
  font-style: normal;
}

blockquote p {
  margin: 10px 0;
}

img {
  border-radius: 1.25rem;
  float: left;
}

ul {
  padding: 0;
  margin: 0;
  padding-left: 1.75rem;
}
ul > li::marker {
  color: black;
  margin-bottom: 0;
}
ol > li::marker {
  color: black;
  margin-bottom: 0;
}
@import "";

/* FONTS */

/* @font-face {
  font-family: "LXGWWenKai-Blod";
  font-display: block;
  src: url("file:///C://Users//%E5%91%A8%E5%AE%8F%E5%93%B2//AppData//Roaming//Typora/themes/ladder/LXGWWenKai-Bold.woff2") format("truetype");
  font-named-instance: "Blod";
} */

/* VARIABLES */

:root {
  --theme-0: #fff;

  /* Slate grayscale */
  --theme-50: #f8fafc;
  --theme-100: #f1f5f9;
  --theme-200: #e2e8f0;
  --theme-300: #cbd5e1;
  --theme-400: #94a3b8;
  --theme-500: #64748b;
  --theme-600: #475569;
  --theme-700: #334155;
  --theme-800: #1e293b;
  --theme-900: #0f172a;

  /* Tailwind variables */
  --tw-primary: #62bbf3;

  --tw-prose-body: var(--theme-700);
  --tw-prose-headings: var(--theme-900);
  --tw-prose-lead: var(--theme-600);
  --tw-prose-links: var(--theme-900);
  --tw-prose-bold: var(--theme-900);
  --tw-prose-counters: var(--theme-500);
  --tw-prose-bullets: var(--theme-300);
  --tw-prose-hr: var(--theme-200);
  --tw-prose-quotes: var(--theme-900);
  --tw-prose-quote-borders: var(--theme-200);
  --tw-prose-captions: var(--theme-500);
  --tw-prose-code: var(--theme-900);
  --tw-prose-pre-code: var(--theme-100);
  --tw-prose-pre-bg: var(--theme-800);
  --tw-prose-th-borders: var(--theme-300);
  --tw-prose-td-borders: var(--theme-200);
  --tw-prose-bg: var(--theme-0);
  --tw-prose-meta: var(--theme-500);
  --tw-prose-meta-bg: var(--theme-100);

  --tw-prose-invert-body: var(--theme-300);
  --tw-prose-invert-headings: var(--theme-0);
  --tw-prose-invert-lead: var(--theme-400);
  --tw-prose-invert-links: var(--theme-0);
  --tw-prose-invert-bold: var(--theme-0);
  --tw-prose-invert-counters: var(--theme-400);
  --tw-prose-invert-bullets: var(--theme-600);
  --tw-prose-invert-hr: var(--theme-700);
  --tw-prose-invert-quotes: var(--theme-100);
  --tw-prose-invert-quote-borders: var(--theme-700);
  --tw-prose-invert-captions: var(--theme-400);
  --tw-prose-invert-code: var(--theme-0);
  --tw-prose-invert-pre-bg: var(--theme-900);
  --tw-prose-invert-th-borders: var(--theme-600);
  --tw-prose-invert-td-borders: var(--theme-700);
  --tw-prose-invert-bg: var(--theme-800);
  --tw-prose-invert-meta: var(--theme-400);
  --tw-prose-invert-meta-bg: var(--theme-700);

  --tw-highlight-color: #fde047; /* yellow-300 */
  --tw-drop-shadow-md: drop-shadow(0 4px 3px rgb(0 0 0 / 0.07))
    drop-shadow(0 2px 2px rgb(0 0 0 / 0.06));
  --tw-button-hover-bg: var(--theme-100);

  --tw-button-hover-bg-inverted: var(--theme-700);

  /* Typora variables */

  --background: var(--tw-prose-bg);
  --bg-color: var(--tw-prose-bg);
  --text-color: var(--tw-prose-body);
  --primary-color: var(--tw-primary);
  --md-char-color: var(--theme-400);
  --meta-content-color: var(--theme-500);
  --typora-source-body: var(--theme-800);
  --heading-char-color: var(--md-char-color);
  --mermaid-theme: neutral;
  --active-toggle-btn-color: var(--theme-200);

  --md-char-color-inverted: var(--theme-500);
  --meta-content-color-inverted: var(--theme-400);
  --typora-source-body-inverted: var(--theme-300);
  --mermaid-theme-inverted: dark;
  --active-toggle-btn-color-inverted: var(--theme-400);

  /* Sidebar */
  --side-bar-bg-color: var(--tw-prose-bg);
  --active-file-bg-color: var(--theme-100);
  --active-file-text-color: var(--tw-prose-bold);
  --active-file-border-color: var(--theme-100);
  --panel-border-color: var(--theme-300);
  --blur-text-color: var(--theme-300);
  --window-border: 1px solid var(--theme-200);
  --item-hover-bg-color: var(--theme-100);
  --search-hit-text-bg-color: var(--theme-200);
  --search-hit-text-font-color: inherit;
  --search-select-text-color: var(--select-text-font-color);
  --search-select-bg-color: var(--select-text-bg-color);

  --blur-text-color-inverted: var(--theme-500);
  --panel-border-color-inverted: var(--theme-700);
  --active-file-bg-color-inverted: var(--theme-700);
  --window-border-inverted: 1px solid var(--theme-700);
  --search-hit-text-bg-color-inverted: var(--theme-700);
  --search-hit-text-font-color-inverted: var(--theme-0);
  --search-select-bg-color-inverted: var(--theme-400);
  --rawblock-edit-panel-bd: var(--tw-prose-pre-bg);
  --item-hover-bg-color-inverted: var(--theme-700);

  --monospace: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
    "Liberation Mono", "Courier New", monospace;

  /* Custom */
  --footnote: var(--tw-prose-body);
  /* I'd love to use the --theme grayscale for --footnote-bg, but there's (currently)
  no way to add an alpha-channel to a CSS variable (and we need the transparency
  because otherwise the caret wil not be visible), so I here just used a hardcoded
  copy of --theme-500 */
  --footnote-bg: #94a3b855;
  --button-bg: var(--theme-200);

  --button-bg-inverted: var(--theme-600);

  --md-grid-header: var(--theme-100);
  --md-grid-header-ext: var(--theme-400);
  --md-grid-ext: var(--theme-300);
  --md-grid-header-active: var(--theme-500);
  --md-grid-active: var(--theme-400);
  --md-grid-border-color: var(--theme-500);

  --md-grid-header-inverted: var(--theme-600);
  --md-grid-header-ext-inverted: var(--theme-500);
  --md-grid-ext-inverted: var(--theme-600);
  --md-grid-header-active-inverted: var(--theme-400);
  --md-grid-active-inverted: var(--theme-500);
  --md-grid-border-color-inverted: var(--theme-200);

  --code-blocks-font-size: 0.9em;
  --inline-code-font-size: 0.9em;
}

.ty-file-search-match-text {
  background-color: var(--search-hit-text-bg-color);
}

/* TAILWIND RESET */

/*
1. Prevent padding and border from affecting element width. (https://github.com/mozdevs/cssremedy/issues/4)
2. Allow adding a border to an element by just adding a border-width. (https://github.com/tailwindcss/tailwindcss/pull/116)
*/

*,
::before,
::after {
  box-sizing: border-box;
  /* 1 */
  border-width: 0;
  /* 2 */
  border-style: solid;
  /* 2 */
  border-color: currentColor;
  /* 2 */
}

::before,
::after {
  --tw-content: "";
}

/*
1. Use a consistent sensible line-height in all browsers.
2. Prevent adjustments of font size after orientation changes in iOS.
3. Use a more readable tab size.
*/

#text {
  line-height: 1.5;
  /* 1 */
  -webkit-text-size-adjust: 100%;
  /* 2 */
  -moz-tab-size: 4;
  /* 3 */
  -o-tab-size: 4;
  tab-size: 4;
  /* 3 */
}

/*
1. Remove the margin in all browsers.
2. Inherit line-height from `html` so users can set them as a class directly on the `html` element.
*/

#text {
  margin: 0;
  /* 1 */
  line-height: inherit;
  /* 2 */
}

/*
1. Add the correct height in Firefox.
2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)
3. Ensure horizontal rules are visible by default.
*/

hr {
  height: 0;
  /* 1 */
  color: inherit;
  /* 2 */
  border-top-width: 1px;
  /* 3 */
}

/*
Add the correct text decoration in Chrome, Edge, and Safari.
*/

abbr:where([title]) {
  -webkit-text-decoration: underline dotted;
  text-decoration: underline dotted;
}

/*
Remove the default font size and weight for headings.
*/

h1,
h2,
h3,
h4,
h5,
h6 {
  font-size: inherit;
  font-weight: inherit;
  /* font-family: "LXGWWenKai-Blod"; */
  font-family: "PingFang SC";
}

/*
Reset links to optimize for opt-in styling instead of opt-out.
*/

a {
  color: inherit;
  text-decoration: inherit;
}

/*
Add the correct font weight in Edge and Safari.
*/

b,
strong {
  font-weight: bolder;
}

/*
1. Use the user's configured `mono` font family by default.
2. Correct the odd `em` font sizing in all browsers.
*/

code,
kbd,
samp,
pre {
  font-family: var(--monospace);
  /* 1 */
  font-size: 1em;
  /* 2 */
}

/*
Add the correct font size in all browsers.
*/

small {
  font-size: 80%;
}

/*
Prevent `sub` and `sup` elements from affecting the line height in all browsers.
*/

sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

sub {
  bottom: -0.25em;
}

sup {
  top: -0.5em;
}

/*
1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)
2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)
3. Remove gaps between table borders by default.
*/

table {
  text-indent: 0;
  /* 1 */
  border-color: inherit;
  /* 2 */
  border-collapse: collapse;
  /* 3 */
}

/*
1. Change the font styles in all browsers.
2. Remove the margin in Firefox and Safari.
3. Remove default padding in all browsers.
*/

button,
input,
optgroup,
select,
textarea {
  font-family: inherit;
  /* 1 */
  font-size: 100%;
  /* 1 */
  line-height: inherit;
  /* 1 */
  color: inherit;
  /* 1 */
  margin: 0;
  /* 2 */
  padding: 0;
  /* 3 */
}

/*
Removes the default spacing and border for appropriate elements.
*/

blockquote,
dl,
dd,
h1,
h2,
h3,
h4,
h5,
h6,
hr,
figure,
p,
pre {
  margin: 0;
}

fieldset {
  margin: 0;
  padding: 0;
}

legend {
  padding: 0;
}

ol,
ul,
menu {
  list-style: none;
  margin: 0;
  padding: 0;
}

/*
Prevent resizing textareas horizontally by default.
*/

textarea {
  resize: vertical;
}

/* TAILWIND PROSE IMPLEMENTATION */

#write {
  font-size: 1.25rem /* 20px */;
  line-height: 1.8;
}

html,
body {
  font-family: "PingFang SC";
}

/* on Windows/Linux, it is the part that is not titlebar or status bar. */
content,
titlebar {
  background: var(--tw-prose-bg);
}

#write {
  padding-top: 30px;
  padding-bottom: 30px;
  color: var(--tw-prose-body);
  max-width: 60ch;
}

#write > :where(:first-child) {
  margin-top: 0;
}

#write > :where(:last-child) {
  margin-bottom: 0;
}

/**
  * ---------------------
  * Block Elements
  */

/* yaml */
pre.md-meta-block {
  color: var(--tw-prose-meta);
  background-color: var(--tw-prose-meta-bg);
  font-weight: 400;
  font-size: var(--code-blocks-font-size);
  line-height: 1.7777778;
  border-radius: 0.5rem /* 8px */;
  padding: 1.1111111em 1.3333333em;
  margin-bottom: 2.8em;
}

/* headings */
h1 {
  color: var(--tw-prose-headings);
  font-weight: 800;
  font-size: 2.8em;
  margin-top: 0;
  margin-bottom: 0.8571429em;
  line-height: 1;
}

h1 strong {
  font-weight: 900;
}

h2 {
  color: var(--tw-prose-headings);
  font-weight: 700;
  font-size: 1.8em;
  margin-top: 1.5555556em;
  margin-bottom: 0.8888889em;
  line-height: 1.1111111;
}

h2 strong {
  font-weight: 800;
}

h3 {
  color: var(--tw-prose-headings);
  font-weight: 600;
  font-size: 1.5em;
  margin-top: 1.6em;
  margin-bottom: 0.6666667em;
  line-height: 1.3333333;
}

h3 strong {
  font-weight: 700;
}

h4 {
  color: var(--tw-prose-headings);
  font-weight: 600;
  margin-top: 1.8em;
  margin-bottom: 0.6em;
  line-height: 1.6;
}

h4 strong {
  font-weight: 700;
}

h2 code {
  font-size: 0.8611111em;
}

h3 code {
  font-size: 0.9em;
}

h2 + * {
  margin-top: 0;
}

h3 + * {
  margin-top: 0;
}

h4 + * {
  margin-top: 0;
}

/* table */

table {
  width: 100%;
  table-layout: auto;
  text-align: left;
  margin-top: 2em;
  margin-bottom: 2em;
  font-size: 0.9em;
  line-height: 1.5555556;
}

/* table header */

thead {
  border-bottom-width: 1px;
  border-bottom-color: var(--tw-prose-th-borders);
}

thead th {
  color: var(--tw-prose-headings);
  font-weight: 600;
  vertical-align: bottom;
  padding-right: 0.6666667em;
  padding-bottom: 0.8888889em;
  padding-left: 0.6666667em;
}

thead th:first-child {
  padding-left: 0;
}

thead th:last-child {
  padding-right: 0;
}

tbody tr {
  border-bottom-width: 1px;
  border-bottom-color: var(--tw-prose-td-borders);
}

tbody tr:last-child {
  border-bottom-width: 0;
}

tbody td {
  vertical-align: baseline;
  padding-top: 0.8888889em;
  padding-right: 0.6666667em;
  padding-bottom: 0.8888889em;
  padding-left: 0.6666667em;
}

tbody td:first-child {
  padding-left: 0;
}

tbody td:last-child {
  padding-right: 0;
}

.md-grid-board tr[row="1"] {
  background-color: var(--md-grid-header);
}

.md-grid-board a:hover,
.md-grid-board a.md-active {
  background: var(--md-grid-active);
}

.md-grid-board tr[row="1"] a:hover,
.md-grid-board tr[row="1"] a.md-active {
  background: var(--md-grid-header-active);
}

.md-grid-board .md-grid-ext {
  background: var(--md-grid-ext);
}

.md-grid-board tr[row="1"] .md-grid-ext {
  background: var(--md-grid-header-ext);
}

.md-grid-board a {
  border-color: var(--md-grid-border-color) !important;
}

/* lists */

ol {
  list-style-type: decimal;
  padding-left: 1.6em;
}

li {
  margin-top: 0.6em;
  margin-bottom: 0.6em;
}

ul {
  list-style-type: disc;
  padding-left: 1.6em;
}

#write ul.task-list {
  padding-left: 0;
}

#write li.task-list-item {
  padding-left: 0.4em;
}

#write input[type="checkbox"] {
  margin-left: -1em;
}

input[checked] ~ * {
  opacity: 0.7;
  text-decoration: line-through;
}

ol > li::marker {
  font-weight: 400;
  color: var(--tw-prose-counters);
}

ul > li::marker {
  color: var(--tw-prose-bullets);
}

ul > li,
ol > li {
  padding-left: 0.4em;
}

ul > li p,
ol > li p {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}

#write > ul > li > :not(input):first-child,
#write > ol > li > :not(input):first-child,
#write > ul > li > input + *,
#write > ol > li > input + * {
  margin-top: 1.2em;
}

#write > ul > li > *:last-child,
#write > ol > li > *:last-child {
  margin-bottom: 1.2em;
}

#write ul > li > p:only-child,
#write ol > li > p:only-child,
#write ul > li > input + p:last-child,
#write ol > li > input + p:last-child {
  margin-top: 0;
  margin-bottom: 0;
}

ul ul,
ul ol,
ol ul,
ol ol {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}

/* blockquote */
blockquote {
  font-weight: 500;
  font-style: italic;
  color: var(--tw-prose-quotes);
  border-left-width: 0.25rem;
  border-left-color: var(--tw-prose-quote-borders);
  quotes: "\201C""\201D""\2018""\2019";
  margin-top: 1.6em;
  margin-bottom: 1.6em;
  padding-left: 1.0666667em;
}

blockquote p:first-of-type::before {
  /* content: open-quote; */
}

blockquote p:last-of-type::after {
  /* content: close-quote; */
}

/* hr */
hr {
  border-color: var(--tw-prose-hr);
  border-top-width: 1px;
}

[mdtype="hr"] {
  margin-top: 2.8em;
  margin-bottom: 2.8em;
}

p {
  margin-top: 1.2em;
  margin-bottom: 1.2em;
}

/* diagram panel */
.md-diagram-panel {
  color: var(--tw-prose-body);
}

.enable-diagrams .md-diagram .code-tooltip {
  bottom: -1.9em;
  right: 0;
}

.md-fences-adv-panel {
  margin-top: 1.3em;
}

/* footnote definition */
sup.md-footnote {
  color: var(--footnote);
  background-color: var(--footnote-bg);
}

.footnotes {
  font-size: 0.85em;
}

.md-reverse-footnote-area a {
  font-family: "PingFang SC";
  text-decoration: none;
  color: var(--tw-primary);
  border-radius: 3px;
}

.md-hover-tip .code-tooltip-content {
  font-size: 1.05rem;
  line-height: 1.6;
  padding: 0.8em 1.2em;
}

.md-reverse-footnote-area a:hover {
  background-color: var(--item-hover-bg-color);
}

.md-def-name:before {
  color: var(--md-char-color);
}

.md-rawblock.md-rawblock-on-edit,
.md-rawblock:hover {
  color: var(--tw-prose-pre-code);
}

.md-inline-math script {
  color: var(--tw-prose-code);
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: var(--tw-highlight-color) !important;
}

g[data-mml-node="merror"] > g {
  fill: #000 !important;
  stroke: #000 !important;
}

.code-tooltip {
  color: var(--tw-prose-pre-code);
}

.code-tooltip .md-mathjax-preview {
  color: var(--tw-prose-body);
}

.md-htmlblock-container,
.md-rawblock-input.md-rawblock-control,
.md-htmlblock-panel.md-rawblock-control,
.md-math-container {
  border-radius: 0.5rem 0 0.5rem 0.5rem;
}

.md-rawblock-input {
  font-size: var(--code-blocks-font-size);
  padding: 0 1.3333333em;
}

.md-mathblock-panel .md-rawblock-input.md-rawblock-control {
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-radius: 0;
}

.md-mathblock-panel .md-rawblock-before {
  padding-top: 1.1em;
  border-top-left-radius: 0.5rem;
}

.md-mathblock-panel .md-rawblock-after {
  padding-bottom: 1.1em;
  border-bottom-left-radius: 0.5rem;
  border-bottom-right-radius: 0.5rem;
}

.md-htmlblock-panel .md-rawblock-input {
  padding-top: 1.1111111em;
  padding-bottom: 1.1111111em;
}

.md-mathblock-panel .md-rawblock-before,
.md-mathblock-panel .md-rawblock-after {
  font-size: var(--code-blocks-font-size);
  padding-left: calc(4px + 1.3333333em);
  color: var(--code-bracket);
}

.md-rawblock-tooltip {
  color: var(--tw-prose-pre-code);
  border-radius: 0.5rem 0.5rem 0 0;
}

.md-rawblock-tooltip-name {
  opacity: 1;
}

.md-comment {
  font-size: var(--inline-code-font-size);
  color: var(--code-comment);
}

.md-raw-inline,
.md-tag,
[md-inline="linebreak"],
.md-image > .md-meta,
.md-inline-math.md-expand > .md-inline-math-container {
  font-size: var(--code-blocks-font-size);
}

/**
  * Code Fences
  * see http://support.typora.io/Code-Block-Styles
  */

.md-fences {
  color: var(--tw-prose-pre-code);
  background-color: var(--tw-prose-pre-bg);
  font-weight: 400;
  font-size: var(--code-blocks-font-size);
  line-height: 1.7777778;
  margin-top: 2em;
  margin-bottom: 2em;
  border-radius: 0.5rem /* 8px */;
  padding: 1.1111111em 1.3333333em;
}

.md-fences.md-focus {
  border-bottom-right-radius: 0;
}

.md-fences > .code-tooltip {
  height: 1.8rem;
  bottom: -1.8rem;
  font-size: 0.9rem;
  border-radius: 0 0 0.5rem 0.5rem;
}

.code-tooltip .ty-input {
  min-width: 10rem;
}

pre code {
  background-color: transparent;
  border-width: 0;
  border-radius: 0;
  padding: 0;
  font-weight: inherit;
  color: inherit;
  font-size: inherit;
  font-family: inherit;
  line-height: inherit;
}

pre code::before {
  content: none;
}

pre code::after {
  content: none;
}

/* SYNTAX HIGHLIGHTING */

:root {
  --code-neutral: var(--theme-800);
  --code-cursor: var(--theme-900);
  --code-string: rgb(14, 165, 233); /* sky-500 */
  --code-number: rgb(245, 158, 11); /* amber-500 */
  --code-tag: rgb(236, 72, 153); /* pink-500 */
  --code-variable: var(--theme-700);
  --code-operator: var(--theme-600);
  --code-comment: var(--theme-500);
  --code-bracket: var(--theme-500);
  --code-citation: var(--theme-500);

  --code-neutral-inverted: var(--theme-100);
  --code-cursor-inverted: var(--theme-50);
  --code-string-inverted: #7dd4fc; /* sky-300 */
  --code-number-inverted: #fde68a; /* amber-100 */
  --code-tag-inverted: #f472b5; /* pink-400 */
  --code-variable-inverted: var(--theme-200);
  --code-operator-inverted: var(--theme-400);
  --code-comment-inverted: var(--theme-400);
  --code-bracket-inverted: var(--theme-500);
  --code-citation-inverted: var(--theme-400);
}

#write .cm-s-inner {
  --code-neutral: var(--code-neutral-inverted);
  --code-cursor: var(--code-cursor-inverted);
  --code-string: var(--code-string-inverted);
  --code-number: var(--code-number-inverted);
  --code-tag: var(--code-tag-inverted);
  --code-variable: var(--code-variable-inverted);
  --code-operator: var(--code-operator-inverted);
  --code-comment: var(--code-comment-inverted);
  --code-bracket: var(--code-bracket-inverted);
  --code-citation: var(--code-citation-inverted);
}

.CodeMirror-selectedtext {
  background-color: transparent;
}
.CodeMirror-cursor {
  border-left: 1px solid var(--code-cursor) !important;
}
.CodeMirror-gutters {
  border-color: var(--code-comment);
}
.cm-s-inner span.cm-string {
  color: var(--code-string);
}

.cm-s-inner span.cm-number {
  color: var(--code-number);
}

.cm-s-inner span.cm-tag,
.cm-s-inner span.cm-keyword,
.cm-s-inner span.cm-qualifier {
  color: var(--code-tag);
}

.cm-s-inner .CodeMirror-guttermarker,
.cm-s-inner .CodeMirror-guttermarker-subtle,
.cm-s-inner span.cm-comment.cm-def,
.cm-s-inner span.cm-comment.cm-type,
.cm-s-inner span.cm-builtin,
.cm-s-inner span.cm-type,
.cm-s-inner span.cm-header,
.cm-s-inner span.cm-link,
.cm-s-inner span.cm-error {
  background: transparent;
  color: var(--code-neutral);
}

.cm-s-inner span.cm-attribute,
.cm-s-inner span.cm-property,
.cm-s-inner span.cm-variable,
.cm-s-inner span.cm-variable-2,
.cm-s-inner span.cm-variable-3,
.cm-s-inner span.cm-type,
.cm-s-inner span.cm-atom,
.cm-s-inner span.cm-def {
  color: var(--code-variable);
}
.cm-s-inner span.cm-comment,
.cm-s-inner .CodeMirror-linenumber {
  color: var(--code-comment);
}
.cm-s-inner span.cm-operator {
  color: var(--code-operator);
}
.cm-s-inner span.cm-bracket,
.cm-s-inner span.cm-tag.cm-bracket,
.cm-s-inner span.cm-meta {
  color: var(--code-bracket);
}

.cm-s-inner span.cm-link {
  text-decoration: underline;
}

/**
  * Inline Elements
  */

/* basic styles */

code {
  color: var(--tw-prose-code);
  font-weight: 600;
  font-size: var(--inline-code-font-size);
}

code::before {
  content: "`";
}

code::after {
  content: "`";
}

[md-inline="code"].md-expand > code::before,
[md-inline="code"].md-expand > code::after {
  content: "";
}

a code {
  color: var(--tw-prose-links);
}

mark code {
  color: inherit;
}

strong {
  color: var(--tw-prose-bold);
  font-weight: 600;
}

a {
  color: var(--tw-prose-links);
  text-decoration: underline;
  font-weight: 500;
}

/* A block-level image should have a total top and bottom margin of 2em.
It is always wrapped in a paragraph with 1.2em vertical margin, hence we
add 0.8 here */
p > .md-image:only-child {
  margin-top: 0.8em !important;
  margin-bottom: 0.8em !important;
}

.md-image > .md-meta {
  color: var(--tw-prose-code);
}

/* extend styles */

mark {
  border-radius: 3px;
  padding: 0 2px;
  background-color: var(--tw-highlight-color);
}

/**
  * Source Code Mode
  * see http://support.typora.io/Code-Block-Styles
  */

.cm-s-typora-default .CodeMirror-activeline-background {
  background-color: var(--item-hover-bg-color);
}

#typora-source {
  font-family: var(--monospace);
  color: var(--typora-source-body);
}

#typora-source .cm-header {
  color: var(--code-tag);
}

#typora-source .cm-link {
  color: var(--code-string);
}

#typora-source .cm-string {
  color: var(--code-string);
}

#typora-source .cm-comment {
  color: var(--code-comment);
}

#typora-source .cm-atom {
  color: var(--code-citation);
}

#typora-source .cm-tag {
  color: var(--code-tag);
}

#typora-source .cm-attribute {
  color: var(--code-variable);
}

#typora-source .cm-bracket {
  color: var(--code-bracket);
}

.file-list-item-file-ext-part {
  opacity: 0.5;
}

#write div.md-toc-tooltip {
  background-color: var(--tw-prose-bg);
}

.md-toc {
  font-size: 0.8em;
}

.md-toc-h1 .md-toc-inner {
  margin-left: 0;
}

.md-toc-h2 .md-toc-inner {
  margin-left: 1em;
}

.md-toc-h3 .md-toc-inner {
  margin-left: 2em;
}

.md-toc-h4 .md-toc-inner {
  margin-left: 3em;
}

.md-toc-h5 .md-toc-inner {
  margin-left: 4em;
}

.md-toc-h6 .md-toc-inner {
  margin-left: 5em;
}

#typora-sidebar {
  border-right: var(--window-border);
}

.sidebar-tab {
  text-transform: none;
  font-weight: 700;
  font-size: 1.1em;
}

.md-search-hit {
  color: var(--search-hit-text-font-color);
  background-color: var(--search-hit-text-bg-color);
}

#md-searchpanel {
  box-shadow: none;
  filter: var(--tw-drop-shadow-md);
}

#md-searchpanel .btn:not(.close-btn):hover {
  box-shadow: none;
  -webkit-box-shadow: none;
  background-color: var(--tw-button-hover-bg);
}

#md-searchpanel input,
#md-searchpanel .btn,
#searchpanel-msg {
  border-radius: 5px;
}

#searchpanel-msg {
  color: var(--theme-500);
  border-color: var(--theme-300);
  background: var(--theme-100);
}

.form-control {
  border-color: var(--panel-border-color);
}

.btn-default {
  background-color: var(--button-bg);
}


code {
  font-family: Menlo, Monaco, Consolas, Courier New, monospace;
  word-break: break-word;
  border-radius: .125rem;
  overflow-x: auto;
  background-color: #fff5f5;
  color: #ff502c;
  font-size: 0.87em;
  padding: 0.065em 0.4em;
}

a {
  text-decoration: none;
  color: #0269c8;
  border-bottom: 1px solid #d1e9ff;
}

code::before {
  content: none;
}

code::after {
  content: none;
}

#write {
  font-size: 16px;
  line-height: 26px;
  max-width: 928px;
}

@media only screen and (min-width: 87.5rem) {
  #write {
    max-width: 1024px;
  }
}

@media only screen and (min-width: 112.5rem) {
  #write {
    max-width: 1200px;
  }
}
p {
  line-height: inherit;
    margin-top: 22px;
    margin-bottom: 22px;
}
h1 {
  font-size: 2.5rem;
  line-height: 2.75rem;
  margin-bottom: 1.5rem;
  letter-spacing: -0.0938rem;
}

h2 {
  font-size: 1.375rem;
  line-height: 2.125rem;
  padding-bottom: .75rem;
  border-bottom: .0625rem solid #ececec;
  font-weight: bold;
}

h3 {
  font-size: 1.25rem;
  line-height: 1.75rem;
  margin-top: 2.1875rem;
  margin-bottom: .625rem;
  padding-bottom: .3125rem;
}

h4 {
  font-size: 1.125rem;
  line-height: 1.625rem;
  margin-top: 2.1875rem;
  margin-bottom: .625rem;
  padding-bottom: .3125rem;
  font-weight: bold;
}

h5 {
  font-size: 15.52px;
  line-height: 20px;
  margin-bottom: 24px;
  font-weight: bold;
}

h6 {
  font-size: 14.88px;
  line-height: 16px;
  margin-bottom: 12px;
}

pre,
code,
kbd,
tt,
var {
  font-size: 0.875em;
}

blockquote {
  color: #666;
  padding: 10px 23px;
  margin: 22px 0;
  border-left: 4px solid #cbcbcb;
  background-color: #f8f8f8;
  font-style: normal;
}

blockquote p {
  margin: 10px 0;
}

img {
  border-radius: 1.25rem;
  float: left;
}

ul {
  padding: 0;
  margin: 0;
  padding-left: 1.75rem;
}
ul > li::marker {
  color: black;
  margin-bottom: 0;
}
ol > li::marker {
  color: black;
  margin-bottom: 0;
}

</style>

<title>RetrievalAugmentedGeneration</title>

<style>

  /* 内容区域样式 */
  .typora-export-content {
    max-width: 900px; /* 最大宽度，控制所有内容的宽度 */
    margin-top: 80px;
    margin: 76px auto; /* 上下外边距10px，左右自动居中 */
    padding: 0 20px; /* 上下内边距为0，左右内边距为20px */
    background-color: white; /* 内容背景色 */
    border-radius: 8px; /* 圆角边框 */
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* 阴影效果 */
    transform: translateX(18px);
  }

  body {
    background-color: #ffffff;
  }

  .smaller-title {
    font-size: 1.5em; /* 你可以根据需要调整字体大小 */
    text-align: center; /* 居中处理 */
  }

  /* 图片容器样式 */
  .image-container {
    display: flex;
    flex-direction: column;
    align-items: center; /* 确保图片居中 */
    width: 100%;
    margin: 20px 0;
}

.image-container img {
  width: 100%; /* 图片宽度占满容器 */
  max-width: 550px; /* 设置图片的最大宽度 */
  height: auto; /* 保持宽高比 */
  display: block; /* 确保图片自身是块级元素 */
  margin: 0 auto; /* 在容器内居中图片 */
}

  /* 段落和标题样式 */
  .typora-export-content p,
  .typora-export-content h2,
  .typora-export-content ul {
    margin: 0 0 20px; /* 下边距 */
  }

  /* 列表样式 */
  .typora-export-content ul {
    padding-left: 20px;
  }

  #author {
    text-align: center; /* 文本居中 */
    display: block; /* 确保它是一个块级元素 */
    font-family: "Microsoft YaHei", sans-serif; /* 设置微软雅黑字体 */
    text-decoration: underline; /* 添加下划线 */
    color: gray; /* 设置文字颜色为灰色 */
  }

  #post_time {
    text-align: center; /* 文本居中 */
    display: block; /* 确保它是一个块级元素 */
    font-family: "Microsoft YaHei", sans-serif; /* 设置微软雅黑字体 */
    color: gray; /* 设置文字颜色为灰色 */
  }

</style>

</head>
<body class='typora-export os-windows'>
  <div class='typora-export-content'>
    <div id='write' class=''>
      <h1 id='title' class='smaller-title'><span>检索增强生成（RAG）技术详解与LangChain实践</span></h1></br>
      <p id = 'author'><span>原创作者：周锦弘</span></p>
      <p id = 'post_time'><span>@ 2024/09/09</span></p></br>
      <h2 id='引言'><span>引言</span></h2>
      <p><span>自从我们发现可以通过整合自身数据来增强大语言模型（LLM）的能力后，如何将 LLM
          的广泛知识与个性化数据相结合，成为了一个备受关注的话题。在这个领域，</span><strong><span>微调（fine-tuning）</span></strong><span>和
        </span><strong><span>检索增强生成（RAG）</span></strong><span>这两种方式常常被拿来比较和讨论，顺便说一下：两者都很重要。</span></p>
      <p>&nbsp;</p>
      <p><span>本文将带你深入了解 RAG 的核心理念，剖析其背后的理论基础。接着，我们会结合实际操作，展示如何使用 LangChain 管理流程，并利用通义千问系列语言模型和 Weaviate
          向量数据库，打造一个简洁但功能强大的 RAG 解决方案。无论你是刚接触这个领域的初学者，还是想要进一步提升技能的专业人士，这篇文章都会为你提供实用的见解和指导。</span></p></br>
      <p>&nbsp;</p>
      <div class="image-container">
        <img src="https://jacksonzjh.github.io/ai-tech/Ai-TechArticles/RetrievalAugmentedGeneration/images/p1.png" alt="Image Description"></br>
      </div>
      <p>&nbsp;</p>
      <h2 id='什么是rag'><span>什么是RAG？</span></h2>
      <p><span>检索增强生成（RAG）是一种方法，旨在为大语言模型（LLM）注入来自外部知识源的额外信息。这使得 LLM
          在生成答案时，不仅更加精准，还能更好地契合上下文。同时，它有效降低了生成误导性信息的风险，让语言模型的回答更加可靠。</span></p>
      <p>&nbsp;</p>
      <p><strong><span>大语言模型存在的问题</span></strong></p>
      <p><span>当前最先进的大语言模型（LLMs）是通过大量数据进行训练的，目的是让它们具备这个世界广泛的通用知识。这些知识被存储在它们的神经网络权重中（即参数记忆）。然而，当我们要求 LLM
          生成的回答涉及到其训练数据之外的信息——比如最新动态、专有内容或某一特定领域的知识时——模型可能会出现事实性错误，这种现象被称为</span><strong><span>“幻觉”</span></strong><span>。以下展示了一个典型的例子：</span>
      </p>
      <p>&nbsp;</p>
      <pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"
        lang="python"
        style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>24</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 30px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">http</span> <span class="cm-keyword">import</span> <span class="cm-variable">HTTPStatus</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">2</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">dashscope</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">3</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">4</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dashscope</span>.<span class="cm-property">api_key</span> <span class="cm-operator">=</span> <span class="cm-string">'sk-xxxxx'</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">5</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">6</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">messages</span> <span class="cm-operator">=</span> [</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">7</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  {<span class="cm-string">'role'</span>: <span class="cm-string">'system'</span>, <span class="cm-string">'content'</span>: <span class="cm-string">'You are a helpful assistant.'</span>},</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">8</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  {<span class="cm-string">'role'</span>: <span class="cm-string">'user'</span>, <span class="cm-string">'content'</span>: <span class="cm-string">'武汉市维普科技公司可以提供哪些产品服务?'</span>}</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">9</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">]</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">10</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">11</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">response</span> <span class="cm-operator">=</span> <span class="cm-variable">dashscope</span>.<span class="cm-property">Generation</span>.<span class="cm-property">call</span>(</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">12</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">model</span><span class="cm-operator">=</span><span class="cm-string">'qwen-72b-chat'</span>,</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">13</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">messages</span><span class="cm-operator">=</span><span class="cm-variable">messages</span>,</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">14</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">result_format</span><span class="cm-operator">=</span><span class="cm-string">'message'</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">15</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">16</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">17</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-variable">response</span>.<span class="cm-property">status_code</span> <span class="cm-operator">==</span> <span class="cm-variable">HTTPStatus</span>.<span class="cm-property">OK</span>:</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">18</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">content</span> <span class="cm-operator">=</span> <span class="cm-variable">response</span>.<span class="cm-property">output</span>.<span class="cm-property">choices</span>[<span class="cm-number">0</span>].<span class="cm-property">message</span>.<span class="cm-property">content</span> <span class="cm-keyword">if</span> <span class="cm-variable">response</span>.<span class="cm-property">output</span> <span class="cm-keyword">and</span> <span class="cm-variable">response</span>.<span class="cm-property">output</span>.<span class="cm-property">choices</span> <span class="cm-keyword">else</span> <span class="cm-string">''</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">19</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-variable">content</span>)</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">20</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">else</span>:</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">21</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'Request id: %s, Status code: %s, error code: %s, error message: %s'</span> <span class="cm-operator">%</span> (</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">22</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">response</span>.<span class="cm-property">request_id</span>, <span class="cm-variable">response</span>.<span class="cm-property">status_code</span>,</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">23</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">response</span>.<span class="cm-property">code</span>, <span class="cm-variable">response</span>.<span class="cm-property">message</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">24</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ))</span></pre>
    </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 896px;"></div>
  <div class="CodeMirror-gutters" style="height: 896px; left: 0px;">
    <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 38px;"></div>
  </div>
  </div>
  </div>
  </pre>
  <blockquote>
    <p><span>LLM:</span>
      <span>很抱歉，我没有找到关于“武汉市维普科技公司”的具体信息，可能你提到的这家公司信息不够公开或者已经更名或不存在。建议您确认一下公司的名称和相关信息。</span>
    </p>
  </blockquote>
  <p>&nbsp;</p>
  <p><span>这是 Qwen 语言模型在回答</span><strong><span>“武汉市维普科技公司可以提供哪些产品服务?”</span></strong><span>时出现的问题。因此，缩小 LLM
      的通用常识与特定语境之间的差距变得尤为重要。这样做可以帮助 LLM 生成更准确、符合语境的回答，同时大幅减少出现“幻觉”的可能性。</span></p>
  <p>&nbsp;</p>
  <p><strong><span>解决方案一：</span></strong></p>
  <p><span>传统上，为了让神经网络适应特定领域或私有信息，人们通常通过</span><strong><span>微调模型</span></strong><span>来实现 [
    </span><em><span>模型微调技术方法会在后续文章中做详细介绍</span></em><span> ]
      。虽然这种方法有效，但它需要大量计算资源，成本高昂，且需要丰富的技术知识。因此，模型微调在应对信息快速变化时缺乏灵活性，不太适合高效的动态调整。</span></p>
  <p>&nbsp;</p>
  <p><strong><span>解决方案二：</span></strong></p>
  <p><span>2020年，Lewis 等人在论文《知识密集型 NLP 任务的检索增强生成》(Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks) [1]
      中提出了一种更灵活的技术——</span><strong><span>检索增强生成（RAG）</span></strong><span>。这项技术将生成模型与检索模块相结合，使语言模型能够从易于更新的外部知识源中获取额外信息，提升生成内容的准确性和实时性。</span>
  </p>
  <p>&nbsp;</p>
  <p><span>可以用一个简单的比喻来理解 RAG
      对大语言模型（LLM）的作用：它就像学生参加的开卷考试。在开卷考试中，学生可以携带教科书或笔记，查找解题所需的信息。考试的重点在于考察学生的推理和理解能力，而不是依赖记忆具体细节。同样，RAG 让 LLM
      从外部知识库中检索信息，专注于生成准确、符合上下文的答案，而不依靠语言模型的参数记忆。</span></p>
  <p>&nbsp;</p>
  <p><span>同样，在 RAG 中，事实性知识与 LLM 的推理能力是分离的。事实知识存储在外部知识源中，便于访问和及时更新。具体分为两类：</span></p>
  <ul>
    <li>
      <p><strong><span>参数化知识</span></strong><span>（Parametric knowledge）：通过模型训练获取，隐含存储于神经网络的权重中。</span></p>
    </li>
    <li>
      <p><strong><span>非参数化知识</span></strong><span>（Non-parametric knowledge）：存储在外部知识库中，如向量数据库，供模型在生成时即时检索。</span></p>
    </li>
  </ul>
  <p>&nbsp;</p>
  <p><strong><span>下面是 RAG 工作流程：</span></strong></p></br>
  <p>&nbsp;</p>
  <div class="image-container">
    <img src="https://jacksonzjh.github.io/ai-tech/Ai-TechArticles/RetrievalAugmentedGeneration/images/p2.png" alt="Image Description"></br>
  </div>
  <p>&nbsp;</p>
  <p><strong><span>检索增强生成管道（RAG Pipline / 工作流程）</span></strong></p>
  <ol start=''>
    <li>
      <p><strong><span>检索：</span></strong><span>
          此过程涉及利用用户的查询内容，从外部知识源获取相关信息。具体来说，就是将用户的查询通过嵌入模型转化为向量，以便与向量数据库中的其他上下文信息进行比对。通过这种相似性搜索，可以找到向量数据库中最匹配的前 k
          个数据。</span></p>
    </li>
    <li>
      <p><strong><span>增强：</span></strong><span> 接着，将用户的查询和检索到的额外信息一起嵌入到一个预设的提示模板中。</span></p>
    </li>
    <li>
      <p><strong><span>生成：</span></strong><span> 最后，这个经过检索增强的提示内容会被输入到大语言模型 (LLM) 中，以生成所需的输出。</span></p>
    </li>
  </ol>
  <p>&nbsp;</p>
  <p><span>对于用户的查询，RAG
      会从存储在</span><strong><span>向量数据库</span></strong><span>（PostgreSQL、Milvus、Weaviate...）中的数据源中检索信息。向量数据库与传统数据库（MySQL、MongoDB...）不同，专门存储</span><strong><span>向量数据
        (Vector data)</span></strong><span> 。</span></p>
  <p>&nbsp;</p>
  <p><span>向量数据以</span><strong><span>嵌入（Embedding）</span></strong><span>形式存在，捕捉对象的上下文和含义。例如，假设你希望从AI应用程序获得定制化的响应。</span>
  </p>
  <p>&nbsp;</p>
  <p>
    <span>首先，组织的文档通过嵌入模型转换为嵌入，并存储在向量数据库中。当查询发送到AI语言模型时，查询也被转换为向量嵌入，并通过向量数据库进行相似性搜索，以找到最相似的对象。通过这种方式，基于LLM的应用程序不会出现“幻觉”，因为它已被引导提供基于定制数据的响应。</span>
  </p></br>
  <p>&nbsp;</p>
  <div class="image-container">
    <img src="https://jacksonzjh.github.io/ai-tech/Ai-TechArticles/RetrievalAugmentedGeneration/images/p3.png" alt="Image Description"></br>
  </div>
  <p>&nbsp;</p>
  <h2 id='基于-langchain-的检索增强生成方法实现'><span>基于 LangChain 的检索增强生成方法实现</span></h2>
  <p><span>在这一部分中，我们将展示如何使用 Python，结合阿里云的大语言模型（Qwen）、Weaviate 的向量数据库，以及 text2vec-base
      嵌入模型，构建一个检索增强生成（RAG）流程。通过这个过程，我们将利用 LangChain 来进行整体的流程编排与管理。</span></p>
  <p>&nbsp;</p>
  <p>
    <span>如果你还不太熟悉什么是</span><strong><span>LangChain</span></strong><span>和向量数据库</span><strong><span>Weaviate</span></strong><span>，建议去网上查阅一下基础入门教程，有很多相关的学习资料。</span>
  </p>
  <p>&nbsp;</p>
  <ul>
    <li>
      <p><strong><span>准备工作</span></strong></p>
    </li>
  </ul>
  <p><span>在开始之前，请确保你的系统中已安装以下 Python 依赖包：</span></p>
  <ul>
    <li>
      <p><span>langchain —— 用于整体编排</span></p>
    </li>
    <li>
      <p><span>dashscope —— 阿里云提供的大语言模型服务 (Qwen)</span></p>
    </li>
    <li>
      <p><span>weaviate-client —— 用于操作向量数据库</span></p>
    </li>
    <li>
      <p><span>pytorch —— 用于图像识别和语言处理等应用程序的深度学习框架</span></p>
    </li>
    <li>
      <p><span>text2vec —— 提供嵌入模型 (Text embedding)</span></p>
    </li>
  </ul>
  <p>&nbsp;</p>
  <p><strong><span>安装依赖：</span></strong></p>
  <pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"
    lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre>
  </div>
  <div class="CodeMirror-measure">
    <pre class="CodeMirror-line"
      role="presentation"><span role="presentation" style="padding-right: 0.1px;">pip install -r requirements.txt</span></pre>
  </div>
  <div style="position: relative; z-index: 1;"></div>
  <div class="CodeMirror-code" role="presentation" style="">
    <div style="position: relative;" class="CodeMirror-activeline">
      <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
      <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div>
      <div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">1</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">pip install torch</span></pre>
    </div>
    <div class="" style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">2</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">pip install -r requirements.txt</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">3</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">4</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">git clone https://github.com/shibing624/text2vec.git</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">5</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">cd text2vec</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">6</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">pip install --no-deps .</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">7</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">8</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">pip install langchain </span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">9</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">pip install dashscope </span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">10</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">pip install weaviate-client </span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">11</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">pip install text2vec</span></pre>
    </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 352px;"></div>
  <div class="CodeMirror-gutters" style="height: 352px;">
    <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 38px;"></div>
  </div>
  </div>
  </div>
  </pre>
  <p>&nbsp;</p>
  <p><strong><span>出于安全考虑：</span></strong></p>
  <p><span>另外，我们需要在项目的根目录下的 .env 文件中设置相关的环境变量，将调用AI大模型的 api key
    </span><strong><span>隐藏起来</span></strong><span>。要获取阿里云灵积模型服务的API 密钥，这里需要先注册一个阿里云的账户，开通灵积模型服务：</span><a
      href='https://dashscope.console.aliyun.com/apiKey'><span>阿里云登录 - 欢迎登录阿里云，安全稳定的云计算服务平台</span></a><span>，并在 API
      密钥页面中选择“创建新的密钥”。</span></p>
  <pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"
    lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14px; left: 33px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre>
  <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
    <div>1</div>
  </div>
  </div>
  <div class="CodeMirror-measure"></div>
  <div style="position: relative; z-index: 1;"></div>
  <div class="CodeMirror-code" role="presentation">
    <div class="CodeMirror-activeline" style="position: relative;">
      <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
      <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -29px; width: 29px;"></div>
      <div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -29px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 20px;">1</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">DASHSCOPE_API_KEY="&lt;YOUR_DASHSCOPE_API_KEY&gt;"</span></pre>
    </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 32px;"></div>
  <div class="CodeMirror-gutters" style="height: 32px;">
    <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 28px;"></div>
  </div>
  </div>
  </div>
  </pre>
  <p>&nbsp;</p>
  <p><span>完成这些设置后，运行下面的命令来加载你所设置的环境变量。</span></p>
  <pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"
    lang="python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14px; left: 33px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre>
  <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
    <div>2</div>
  </div>
  </div>
  <div class="CodeMirror-measure"></div>
  <div style="position: relative; z-index: 1;"></div>
  <div class="CodeMirror-code" role="presentation">
    <div class="CodeMirror-activeline" style="position: relative;">
      <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
      <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -29px; width: 29px;"></div>
      <div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -29px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 20px;">1</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">dotenv</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -29px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 20px;">2</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dotenv</span>.<span class="cm-property">load_dotenv</span>()</span></pre>
    </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 64px;"></div>
  <div class="CodeMirror-gutters" style="height: 64px; left: 0px;">
    <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 28px;"></div>
  </div>
  </div>
  </div>
  </pre>
  <p>&nbsp;</p>
  <ul>
    <li>
      <p><strong><span>向量数据嵌入</span></strong></p>
    </li>
  </ul>
  <p><span>首先，我们需要创建一个向量数据库，作为外部知识源，存储所有必要的额外信息。填充数据库的过程包括以下几步：</span></p>
  <ol start=''>
    <li>
      <p><span>收集数据并加载到系统中。</span></p>
    </li>
    <li>
      <p><span>将文档进行分块处理，确保数据合理划分。</span></p>
    </li>
    <li>
      <p><span>对每个分块内容进行嵌入，并将这些嵌入存储在向量数据库中。</span></p>
    </li>
  </ol>
  <p>&nbsp;</p>
  <p><span>首先，我们需要收集并加载数据。在这个示例中，我们将使用 “武汉市维普科技公司-产品服务” 作为背景信息。为加载这些数据，可以借助 LangChain 提供的多种工具之一，例如
    </span><strong><span>DocumentLoader</span></strong><span>。Document 是包含文本和元数据的字典格式。为了处理文本加载，我们将使用 LangChain 的
    </span><strong><span>TextLoader</span></strong><span>。</span></p>
  <p>&nbsp;</p>
  <pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"
    lang="python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14px; left: 33px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -29px; width: 29px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -29px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 20px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">langchain</span>.<span class="cm-property">document_loaders</span> <span class="cm-keyword">import</span> <span class="cm-variable">TextLoader</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -29px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 20px;">2</div>
    </div>
    <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -29px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 20px;">3</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">loader</span> <span class="cm-operator">=</span> <span class="cm-variable">TextLoader</span>(<span class="cm-string">'./维普科技公司-产品服务.txt'</span>)</span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -29px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
        style="left: 0px; width: 20px;">4</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">documents</span> <span class="cm-operator">=</span> <span class="cm-variable">loader</span>.<span class="cm-property">load</span>()</span></pre>
  </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 128px;"></div>
  <div class="CodeMirror-gutters" style="height: 128px; left: 0px;">
    <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 28px;"></div>
  </div>
  </div>
  </div>
  </pre>
  <p>&nbsp;</p>
  <p><span>接下来需要对文档进行分块处理。由于原始 Document 的大小超出 LLM 的处理窗口，因此必须将其切割成较小的片段。LangChain 提供了多种文本分割工具，针对这一简单示例，可以使用
    </span><strong><span>CharacterTextSplitter</span></strong><span>。将
    </span><strong><span>chunk_size</span></strong><span> 设置为约 500，并将
    </span><strong><span>chunk_overlap</span></strong><span> 设置为 50，以确保相邻文本块之间的连贯性。</span></p>
  <p>&nbsp;</p>
  <pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"
    lang="python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14px; left: 33px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -29px; width: 29px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -29px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 20px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">langchain</span>.<span class="cm-property">text_splitter</span> <span class="cm-keyword">import</span> <span class="cm-variable">CharacterTextSplitter</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -29px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 20px;">2</div>
    </div>
    <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -29px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 20px;">3</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">text_splitter</span> <span class="cm-operator">=</span> <span class="cm-variable">CharacterTextSplitter</span>(<span class="cm-variable">chunk_size</span><span class="cm-operator">=</span><span class="cm-number">500</span>, <span class="cm-variable">chunk_overlap</span><span class="cm-operator">=</span><span class="cm-number">50</span>)</span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -29px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
        style="left: 0px; width: 20px;">4</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">chunks</span> <span class="cm-operator">=</span> <span class="cm-variable">text_splitter</span>.<span class="cm-property">split_documents</span>(<span class="cm-variable">documents</span>)</span></pre>
  </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 160px;"></div>
  <div class="CodeMirror-gutters" style="height: 160px; left: 0px;">
    <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 28px;"></div>
  </div>
  </div>
  </div>
  </pre>
  <p>&nbsp;</p>
  <p><span>最后一步是对文本块进行嵌入并存储。为了实现文本块的</span><strong><span>语义搜索</span></strong><span>，需要为每个块生成向量嵌入，并将它们存储起来。可以使用
      text2vec-base 嵌入模型来生成</span><strong><span>向量嵌入</span></strong><span>，而 Weaviate 向量数据库则负责存储这些嵌入。通过
    </span><strong><span>.from_documents()</span></strong><span> 方法，文本块会自动填充进向量数据库。</span></p>
  <p>&nbsp;</p>
  <pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"
    style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre>
  <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
    <div>26</div>
  </div>
  </div>
  <div class="CodeMirror-measure"></div>
  <div style="position: relative; z-index: 1;"></div>
  <div class="CodeMirror-code" role="presentation" style="">
    <div class="CodeMirror-activeline" style="position: relative;">
      <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
      <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div>
      <div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">1</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">langchain</span>.<span class="cm-property">vectorstores</span> <span class="cm-keyword">import</span> <span class="cm-variable">Weaviate</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">2</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">weaviate</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">3</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">weaviate</span>.<span class="cm-property">embedded</span> <span class="cm-keyword">import</span> <span class="cm-variable">EmbeddedOptions</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">4</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">text2vec</span> <span class="cm-keyword">import</span> <span class="cm-variable">SentenceModel</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">5</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">6</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## 初始化 Weaviate 客户端</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">7</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">client</span> <span class="cm-operator">=</span> <span class="cm-variable">weaviate</span>.<span class="cm-property">Client</span>(</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">8</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">embedded_options</span><span class="cm-operator">=</span><span class="cm-variable">EmbeddedOptions</span>()</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">9</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">10</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">11</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## 使用 text2vec-base 生成嵌入模型</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">12</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span> <span class="cm-operator">=</span> <span class="cm-variable">SentenceModel</span>(<span class="cm-string">"shibing624/text2vec-base-chinese"</span>) </span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">13</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">14</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## 定义嵌入函数，适用于 Weaviate 的嵌入向量生成</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">15</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">compute_embeddings</span>(<span class="cm-variable">documents</span>):</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">16</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">sentences</span> <span class="cm-operator">=</span> [<span class="cm-variable">doc</span>.<span class="cm-property">page_content</span> <span class="cm-keyword">for</span> <span class="cm-variable">doc</span> <span class="cm-keyword">in</span> <span class="cm-variable">documents</span>] &nbsp;<span class="cm-comment">## 提取文档中的文本</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">17</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">embeddings</span> <span class="cm-operator">=</span> <span class="cm-variable">model</span>.<span class="cm-property">encode</span>(<span class="cm-variable">sentences</span>) &nbsp;<span class="cm-comment">## 生成嵌入向量</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">18</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">embeddings</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">19</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">20</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## 从文档生成嵌入并填充到向量数据库中</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">21</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">vectorstore</span> <span class="cm-operator">=</span> <span class="cm-variable">Weaviate</span>.<span class="cm-property">from_documents</span>(</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">22</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">client</span><span class="cm-operator">=</span><span class="cm-variable">client</span>,</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">23</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">documents</span><span class="cm-operator">=</span><span class="cm-variable">chunks</span>, &nbsp;<span class="cm-comment">## 文档块</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">24</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">embedding</span><span class="cm-operator">=</span><span class="cm-variable">compute_embeddings</span>, &nbsp;<span class="cm-comment">## 使用 text2vec-base 嵌入</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">25</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">by_text</span><span class="cm-operator">=</span><span class="cm-keyword">False</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">26</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre>
    </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 896px;"></div>
  <div class="CodeMirror-gutters" style="height: 896px; left: 0px;">
    <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 38px;"></div>
  </div>
  </div>
  </div>
  </pre>
  <p>&nbsp;</p>
  <p><strong><span>第一步、检索</span></strong></p>
  <p><span>一旦向量数据库准备就绪，我们就可以将其配置为检索组件。该组件通过分析用户查询与已嵌入文本块之间的语义相似度，检索出相关的上下文信息。</span></p>
  <p>&nbsp;</p>
  <pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"
    lang="python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14px; left: 33px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -29px; width: 29px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -29px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 20px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">retriever</span> <span class="cm-operator">=</span> <span class="cm-variable">vectorstore</span>.<span class="cm-property">as_retriever</span>()</span></pre>
  </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 32px;"></div>
  <div class="CodeMirror-gutters" style="height: 32px; left: 0px;">
    <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 28px;"></div>
  </div>
  </div>
  </div>
  </pre>
  <p>&nbsp;</p>
  <p><strong><span>第二步、增强</span></strong></p>
  <p><span>接下来，我们需要准备一个提示模板（Prompt template），以便用额外的上下文信息来增强原始的提示。你可以根据下面显示的示例，轻松地定制这样一个提示模板。</span></p>
  <p>&nbsp;</p>
  <pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false"
    lang="python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>11</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 30px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">langchain</span>.<span class="cm-property">prompts</span> <span class="cm-keyword">import</span> <span class="cm-variable">ChatPromptTemplate</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">2</div>
    </div>
    <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">3</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">template</span> <span class="cm-operator">=</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">4</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string">"""你是一位专注于问答任务的助手。请使用以下检索到的上下文片段来回答问题。如果你不知道答案，直接说不知道。回答最多用三句话，保持简洁明了。</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">5</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">Question: {question}</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">6</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">Context: {context}</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">7</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">Answer:</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">8</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">9</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">prompt</span> <span class="cm-operator">=</span> <span class="cm-variable">ChatPromptTemplate</span>.<span class="cm-property">from_template</span>(<span class="cm-variable">template</span>)</span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
        style="left: 0px; width: 30px;">10</div>
    </div>
    <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
  </div>
  <div style="position: relative;">
    <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
      <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
        style="left: 0px; width: 30px;">11</div>
    </div>
    <pre class=" CodeMirror-line "
      role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">prompt</span>)</span></pre>
  </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 416px;"></div>
  <div class="CodeMirror-gutters" style="height: 416px; left: 0px;">
    <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 38px;"></div>
  </div>
  </div>
  </div>
  </pre>
  <p>&nbsp;</p>
  <p><strong><span>第三步、生成</span></strong></p>
  <p><span>在构建 RAG（检索增强生成）管道时，可以通过将检索器、提示模板和大语言模型（LLM）组合成一个完整的执行序列。一旦定义好 RAG 流程，便可以开始执行该序列。</span></p>
  <p>&nbsp;</p>
  <pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"
    style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre>
  <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
    <div>22</div>
  </div>
  </div>
  <div class="CodeMirror-measure"></div>
  <div style="position: relative; z-index: 1;"></div>
  <div class="CodeMirror-code" role="presentation" style="">
    <div class="CodeMirror-activeline" style="position: relative;">
      <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
      <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div>
      <div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">1</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">os</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">2</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">langchain</span>.<span class="cm-property">llms</span> <span class="cm-keyword">import</span> <span class="cm-variable">Tongyi</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">3</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">langchain</span>.<span class="cm-property">schema</span>.<span class="cm-property">runnable</span> <span class="cm-keyword">import</span> <span class="cm-variable">RunnablePassthrough</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">4</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">langchain</span>.<span class="cm-property">schema</span>.<span class="cm-property">output_parser</span> <span class="cm-keyword">import</span> <span class="cm-variable">StrOutputParser</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">5</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">6</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## 设置通义千问的API密钥</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">7</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">os</span>.<span class="cm-property">environ</span>[<span class="cm-string">"DASHSCOPE_API_KEY"</span>] <span class="cm-operator">=</span> <span class="cm-string">"your-dashscope-api-key"</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">8</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">9</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">llm</span> <span class="cm-operator">=</span> <span class="cm-variable">Tongyi</span>(<span class="cm-variable">model_name</span><span class="cm-operator">=</span><span class="cm-string">"qwen-72b-chat"</span>, <span class="cm-variable">temperature</span><span class="cm-operator">=</span><span class="cm-number">0.1</span>)</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">10</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">11</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## 构建 RAG 管道</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">12</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rag_chain</span> <span class="cm-operator">=</span> (</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">13</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  {<span class="cm-string">"context"</span>: <span class="cm-variable">retriever</span>, <span class="cm-string">"question"</span>: <span class="cm-variable">RunnablePassthrough</span>()}</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">14</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-operator">|</span> <span class="cm-variable">prompt</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">15</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-operator">|</span> <span class="cm-variable">llm</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">16</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-operator">|</span> <span class="cm-variable">StrOutputParser</span>()</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">17</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">18</div>
      </div>
      <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">19</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## 执行查询</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">20</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">query</span> <span class="cm-operator">=</span> <span class="cm-string">"武汉市维普科技公司可以提供哪些产品服务？"</span></span></pre>
    </div>
    <div style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 30px;">21</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">response</span> <span class="cm-operator">=</span> <span class="cm-variable">rag_chain</span>.<span class="cm-property">invoke</span>(<span class="cm-variable">query</span>)</span></pre>
    </div>
    <div class="" style="position: relative;">
      <div class="CodeMirror-gutter-wrapper" style="left: -39px;">
        <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show"
          style="left: 0px; width: 30px;">22</div>
      </div>
      <pre class=" CodeMirror-line "
        role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">response</span>)</span></pre>
    </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 800px;"></div>
  <div class="CodeMirror-gutters" style="height: 800px;">
    <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 38px;"></div>
  </div>
  </div>
  </div>
  </pre>
  <blockquote>
    <p><span>LLM：</span>
      <span>武汉市维普科技公司提供的产品和服务包括以下几大类：</span>
    </p>
    <ol start=''>
      <li>
        <p><span>大数据服务：涵盖数据采集、治理、分析及可视化，助力数字化转型。</span></p>
      </li>
      <li>
        <p><span>人工智能服务：提供图像与行为识别等定制化 AI 解决方案。</span></p>
      </li>
      <li>
        <p><span>运维与安全服务：提供系统、数据和桌面运维及全生命周期安全管理。</span></p>
      </li>
      <li>
        <p><span>移动互联网服务：快速构建企业移动应用。</span></p>
      </li>
      <li>
        <p><span>物联网服务：云平台支持设备连接与数据采集。</span></p>
      </li>
      <li>
        <p><span>云计算服务：包含云技术研发和云咨询服务。</span></p>
      </li>
    </ol>
  </blockquote>
  <p>&nbsp;</p>
  <p><span>下面展示了这一特定例子的 RAG 管道如何工作的图解：</span></p></br>
  <p>&nbsp;</p>
  <div class="image-container">
    <img src="https://jacksonzjh.github.io/ai-tech/Ai-TechArticles/RetrievalAugmentedGeneration/images/p4.png" alt="Image Description"></br>
  </div>
  <p>&nbsp;</p>
  <h2 id='总结'><span>总结</span></h2>
  <p><span>今天，我们深入了解了 RAG（检索增强生成）技术，这一概念最早在 2020 年发表的论文《面向知识密集型 NLP 任务的检索增强生成》中提出。文中详细讲解了 RAG 的理论基础，包括其动机与解决方案，并展示了如何使用
      Python 进行实现。整个实现过程结合了通义千问大语言模型（Qwen）、Weaviate 向量数据库和 text2vec-base 嵌入模型，同时利用 LangChain
      进行协调管理。希望本文对大家探索AI领域技术上有所帮助！</span></p></br>
  <p>&nbsp;</p>
  <div class="image-container">
    <img src="https://jacksonzjh.github.io/ai-tech/Ai-TechArticles/RetrievalAugmentedGeneration/images/p4.png" alt="Image Description"></br>
  </div>
  <p>&nbsp;</p>
  </div>
  </div>
</body>
</html>